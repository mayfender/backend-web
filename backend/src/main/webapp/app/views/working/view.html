<style>
	fieldset {
		border: 1px solid #BDC3C7;
		border-radius: 5px 5px 5px 5px;
		padding-left: 30px;
	}
	
	.modal-backdrop {
	    display: none;
	}
	.trace .modal {
	    left: 27%;
	    right: inherit;
	    bottom: inherit;
	    
	    /* left: 50%;
	    right: inherit;
	    top: 50%;
	    bottom: inherit;
	    -webkit-transform: translate(-50%, -50%);
	    transform: translate(-50%, -50%); */
	} 
	input[type="number"]::-webkit-outer-spin-button,
	input[type="number"]::-webkit-inner-spin-button {
	    -webkit-appearance: none;
	    margin: 0;
	}
	button[name='capture'].ng-hide.ng-hide-animate{
	     display: none !important;
	}
	.updateInput.ng-hide.ng-hide-animate{
	     display: none !important;
	}
	#detail .label {
		white-space: normal;
	}
	.suspend {
		cursor: not-allowed !important;
		color: transparent !important;
	    text-shadow: 0 0 7px rgba(0,0,0,0.5);
	    user-select: none;
	}
	[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
	  display: none !important;
	}
	.readmore-box-one {
	  -webkit-transition:all linear 0.5s;
	  transition:all linear 0.5s;
	}
	.readmore-box-one.ng-hide {
	  opacity:0;
	}
</style>
<div id="taskDetailStick" style="z-index: 10; background-color: #FFFFFF">
<div class="row">
	<div class="col-xs-12">
		<div class="btn-group pull-left" style="margin: 0px 0 3px 0;">
		  <button type="button" ng-disabled="taskDetail[0].isSuspend" class="btn btn-primary btn-outline" ng-class="{'active': group.btnActive}" ng-repeat="group in groupDatas" ng-click="changeTab(group)">{{ group.name }}</button>
		</div>
		
		<button type="button" style="margin-left: 3px;" class="btn btn-danger btn-outline pull-right" ng-click="disable()" ng-show="isEditable && isDisableBtnShow">ยุติการติดตาม</button>
		
		<div class="panel panel-primary pull-right" style="margin-bottom: 0 !important; margin-left: 3px;">
			<div class="panel-body" style="padding: 6px;">
				<div class="checkbox" style="margin: 0;">
				    <label>
				      <input type="checkbox" value="" data-toggle="collapse" data-target="#collapseAccList" checked="checked">ซ่อนบัญชี
				    </label>&nbsp;
				    <label>
				      <input type="checkbox" value="" data-toggle="collapse" data-target="#collapseActionPanel">ซ่อน Action-Panel
				    </label>
				    <!-- <label>
				      &nbsp;<input type="checkbox" ng-model="isEditMode">โหมดแก้ไข
				    </label> -->
			    </div>
		  	</div>
		</div>
		
		<button type="button" style="margin-left: 3px; margin-right: 15px;" name="capture" class="btn btn-warning pull-right" ng-show="isKYS && !kysIsError" ng-click="captureKYS()">
			<i class="fa fa-crop"></i>        
		</button>
		
		<button type="button" name="capture" class="btn btn-success pull-right" ng-disabled="loanType == 'F201'"
				ng-show="isKYS && !kysIsError && loanType" ng-click="goToKYS('F201')" style="margin-left: 3px;">
			กรอ
		</button>
		
		<button type="button" name="capture" class="btn btn-success pull-right" ng-disabled="loanType == 'F101'"
				ng-show="isKYS && !kysIsError && loanType" ng-click="goToKYS('F101')" >
			กยศ
		</button>
		
	</div>
</div>	

<div class="row" ng-hide="isKYS">
	<div id="detail" class="col-xs-12">
		<div style="background-color: #356190; margin-bottom: 1px; height: 262px; overflow-y: auto;" class="comm-rcorners-1" ng-repeat="detail in taskDetail">
			<div ng-repeat="f in fieldName" class="col-xs-3" style="font-size: 13px; padding: 0; color: #E1E2E3;">
				<div class="col-xs-5" 
					 style="padding: 5px 5px 0 0; text-align: right; margin: 0; min-height: 42px; border-top: 1px solid #234E7C; background-color: #264F7A; word-wrap: break-word; cursor: pointer;"
					 ng-click="showMore(f, detail)">
					<span>{{ f.columnNameAlias || f.columnName }}</span>
				</div>
				<!-- <div class="col-xs-7" style="padding: 1px 0 0 0; border-top: 1px solid #234E7C;"
					 ng-style="(f.isNotice && !isDisableNoticePrintBtn) ? {'cursor': 'pointer'} : {}" ng-click="(f.isNotice && !isDisableNoticePrintBtn && !isEditMode) ? noticeMenu(detail[f.columnName+'_hide'] || detail[f.columnName], f.noticeForms, detail[f.noticeCusColName]) : ''"> -->
				<div class="col-xs-7" style="padding: 1px 0 0 0; border-top: 1px solid #234E7C; cursor: default;">
				     <div ng-style="f.colorBg ? {'display': 'inline-block'} : '' ">
						 <span ng-class="{label: f.colorBg, 'suspend': detail.isSuspend}" 
						 	   style="display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;text-overflow: ellipsis; text-align: left; position: absolute;"
						       ng-style="f.colorBg ? {'color': f.colorFont, 'background-color': f.colorBg, 'font-size': '13px', 'padding': '4px 3px 0px 3px', 'min-height': '23px', 'max-height': '39px', 'line-height': '1.32999999', 'top':'1px'} : f.colorFont ? {'color': f.colorFont} : {'padding': '4px 0 0 0'} ">
								   {{ 
									   f.dataType == 'sys_owner' ? detail[f.columnName][0].showname :
									   f.dataType == 'date' ? (detail[f.columnName] | date:gb_dateFormat) : 
									   f.dataType == 'num' ? (detail[f.columnName] | number:2) : detail[f.columnName] 
									}}
						 </span>
			       	 </div>
				</div>
			</div>
			<div style="clear: both;"></div>
		</div>
	</div>
</div>

<div class="row readmore-box readmore-box-one" ng-show="readMore.fieldName && !taskDetail[0].isSuspend">
	<div class="col-xs-12">
		<div class="comm-rcorners-1" style="overflow: auto; background-color: #356190; margin-bottom: 1px; min-height: 64px; font-size: 13px; color: #E1E2E3; cursor: default;">
			<table style="width: 100%;">
				<tr>
					<td style="width:0.1%; white-space: nowrap; padding-left: 15px;">{{ readMore.fieldName }}&nbsp;&nbsp;</td>
					<td>						
						<div class="well" style="margin: 0; padding: 6px 3px 3px 12px; color: black; min-height: 54px; font-weight: 700; background-color: #5bb9e2;" ng-hide="readMore.isEditMode">
	                        {{
	                        	readMore.f.dataType == 'sys_owner' ? readMore.val :
							    readMore.f.dataType == 'date' ? (readMore.val | date:gb_dateFormat) : 
							    readMore.f.dataType == 'num' ? (readMore.val | number:2) : readMore.val 
	                        }}
	                    </div>
					
						<textarea class="form-control updateInput" rows="2" style="resize: vertical; overflow: visible;" ng-cloak ng-show="readMore.isEditMode && readMore.f.dataType != 'date' && readMore.f.dataType != 'num'" ng-model="readMore.val" ng-readonly="!readMore.isEditMode"></textarea>
						<input type="text" class="form-control updateInput" ng-cloak ng-show="readMore.isEditMode && readMore.f.dataType == 'date'" ng-model="readMore.val" date-parser="dd/MM/yyyy" />
						<input type="text" class="form-control updateInput" ng-cloak ng-show="readMore.isEditMode && readMore.f.dataType == 'num'" ng-model="readMore.val" />
					</td>
					<td style="width:0.1%; white-space: nowrap; padding-left: 15px; padding-right: 10px;" ng-show="readMore.isEditable">
						<i class="fa fa-print fa-lg " ng-show="readMore.f.isNotice && !readMore.isEditMode" title="พิมพ์" style="cursor: pointer; margin-right: 10px;"
						   ng-click="(readMore.f.isNotice && !disNotice) ? noticeMenu(readMore.detail[readMore.f.columnName+'_hide'] || readMore.detail[readMore.f.columnName], readMore.f.noticeForms, readMore.detail[readMore.f.noticeCusColName]) : ''"></i>
						<i class="fa fa-edit fa-lg" style="cursor: pointer;" ng-click="readMore.isEditMode = true" ng-show="!readMore.isEditMode && userEditable" title="แก้ใข"></i>
						<i class="fa fa-floppy-o fa-lg" ng-click="showMoreUpdate()" ng-show="readMore.isEditMode" title="บันทึก"></i>
					</td>
				</tr>
			</table>		
		</div>
	</div>
</div>

</div>

<!-- 
.collapse	    Hides the content
.collapse in	Shows the content 
-->
<!-- <div class="collapse" id="collapseAccList"> -->
	<div class="row" style="margin-top: 3px;" ng-hide="isKYS">
		<div class="col-xs-12" ng-include="'./views/working/tab_tasklist.html'"></div>
	</div>
<!-- </div> -->

<div class="row collapse in" id="collapseActionPanel" ng-hide="isKYS">
	<div class="col-xs-12">
		<div class="btn-group" style="margin: 3px 0 3px 0;">
		  <button type="button" ng-disabled="taskDetail[0].isSuspend" class="btn btn-primary btn-outline" style="min-width: 70px;" ng-class="{'active': menu.btnActive}" ng-repeat="menu in tabActionMenus" ng-click="changeTabAction(menu)" id="{{ menu.id }}">{{ menu.name }}</button>
		</div>
		
		&nbsp;&nbsp;&nbsp;
		<div class="btn-group" style="margin: 3px 0 3px 0;">			
			<button type="button" class="btn btn-primary btn-outline" title="ก่อนหน้า" style="padding: 5px 13px 5px 5px;" ng-click="nextPrev(false, true)" ng-disabled="(rowIndex == 1) || (taskDetails.length == 0)">
		  		<i class="fa fa-hand-o-left fa-1x"></i>
		  	</button>
		  	<button type="button" class="btn btn-primary btn-outline" title="ถัดไป" style="padding: 5px 5px 5px 13px;" ng-click="nextPrev(true, true)" ng-disabled="(rowIndex == totalItems) || (taskDetails.length == 0)">
		  		<i class="fa fa-hand-o-right fa-1x"></i>
		  	</button>
		
			<span class="btn btn-outline" style="padding: 5px 10px 5px 10px; cursor: default; border-color: #5499C7; min-width: 50px;">		
				<!-- <span ng-if="!isSmsEnable && taskDetails.length == 0">&nbsp;</span> -->
				&nbsp;
				<span ng-if="isSmsEnable && taskDetails.length > 0">
		  			<i class="fa fa-envelope fa-1x" style="cursor: pointer;" title="เพิ่มรายการส่ง SMS" ng-click="addSmsList()"></i>
				</span>
				&nbsp;
			</span>
		
			<!-- &nbsp;&nbsp;&nbsp; -->
		  	<button type="button" class="btn btn-primary" title="{{ isOutOfWorkingTime ? 'นอกเวลาทำงาน' : 'บันทึกผลการติดตาม' }}"
		  		    style="padding: 5px 15px 5px 15px;" ng-click="askModal()" ng-disabled="isOutOfWorkingTime || (taskDetails.length == 0) || askModalObj.isOldTrace || lastTabActionMenuActive.id != 1 || taskDetail[0].isSuspend">
				<i class="fa fa fa-plus fa-1x"></i>
			</button>
		</div>
		
	</div>
	<div class="col-xs-12" style="min-height: 315px;" ng-include="taskDetail[0].isSuspend ? emptyHtml : lastTabActionMenuActive.url"></div>
</div>




<!-- Modal -->
 <div class="modal fade" id="myModal" tabindex="-1" role="dialog">
     <div class="modal-dialog">
         <div class="modal-content">
         	<div class="modal-header">
                <button type="button" class="close" ng-click="dismissModal()" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">แบบฟอร์ม Notice</h4>
            </div>
            <div class="modal-body">            	    	
				<div class="panel panel-default" style="margin-bottom: 0; margin-top: 0;">
				  <div class="panel-body">
				  	<div class="row" ng-repeat="file in files"> 
				  		<div style="text-align: center;" class="col-xs-12">
						  	<button class="btn btn-primary col-xs-12" type="button" style="margin-bottom: 3px;" ng-click="printNotice(file.id)">{{ file.templateName }}</button>
				  		</div>
				  	</div>
				  </div>
				</div>
            </div>
           	<div class="modal-footer">
				<button type="button" class="btn btn-default" ng-click="dismissModal()">ปิด</button>
			</div>
         </div>
     </div>
 </div>
<!-- / Modal -->

<!-- Modal -->
<div class="trace">
	 <div class="modal fade" id="myModal_ask" tabindex="-1" role="dialog" style="cursor: move; overflow: visible;">
	     <div class="modal-dialog">
	     	<form name="saveAskModalForm" ng-submit="askModalObj.askModalSave()" novalidate>
		     	<fieldset ng-disabled="askModalObj.isSaving" style="border: 0; border-radius: 0; padding: 0;">
		         <div class="modal-content">
		         	<div class="modal-header">
		                <button type="button" class="close" ng-click="dismissModalAsk()" aria-hidden="true">&times;</button>
		                <h4 class="modal-title">บันทึกผลการติดตาม</h4>
		            </div>
		            <div class="modal-body">
						<div class="panel panel-default" style="margin-bottom: 0; margin-top: 0;">
						  <div class="panel-body">
						  
							
							  <div class="row">
								  <div class="form-group col-xs-8" ng-class="{'has-error':saveAskModalForm.resultText.$invalid}">
								    <label class="control-label">ผลการติดตาม</label>
								    <label class="control-label pull-right">{{ askModalObj.init.maxlength == -1 ? askModalObj.init.currentlength : askModalObj.init.currentlength + '/' + askModalObj.init.maxlength }}</label>
							  		<textarea name="resultText" maxlength="{{ askModalObj.init.maxlength }}" class="form-control" style="resize: none;" rows="3" ng-model="askModalObj.trace.resultText" required></textarea>
								  </div>
								  
								  <div class="form-group col-xs-4">
									<label class="control-label">เบอร์โทร</label>
									<input name="userNameShow" class="form-control" ng-model="askModalObj.trace.tel">
								  </div>
							  </div>
							  
							  <div class="row">
								  <div class="col-xs-6">
									<div class="form-group">
										<label class="control-label">วันนัดชำระ | ยอดนัดชำระ</label>
										<div class="input-group">
						                    <input ng-model-options="{ updateOn: 'blur' }" name="appointDate" type='text' class="form-control input-sm dtPicker" style="width: 130px; font-size: 0.9em;" 
						                    	   ng-model="askModalObj.trace.appointDate" date-parser="dd/MM/yyyy HH:mm" />
										  	<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
						                    <input type="number" class="form-control input-sm" ng-model="askModalObj.trace.appointAmount" ng-disabled="!askModalObj.trace.appointDate" />
										</div>						
									</div>
								  </div>
								  <div class="col-xs-6">					  
									<div class="form-group">
										<label class="control-label">วันนัด Call</label>
									    <div class="input-group">
						                    <input name="nextTimeDate" type='text' class="form-control input-sm dtPicker" style="font-size: 0.9em;" 
						                    	   ng-model="askModalObj.trace.nextTimeDate" date-parser="dd/MM/yyyy HH:mm" />
										  	<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
										</div>
									</div>
								  </div>
								  <div class="col-xs-12">
									  <div class="row">
										  <div class="col-xs-6" ng-repeat="list in dymList">
										  	<div class="form-group">
												<label class="control-label">{{ list.name }}</label>
												<small style="position: absolute; right: 14px; color: #d58512" ng-show="list.isSuspend">
													<i class="fa fa-exclamation-triangle"></i>เว้นการติดต่อ
												</small>
												<div class="input-group input-group-sm">
													<div class="input-group-btn" ng-show="list.dymListDetGroup.length > 0">
														<select style="height: 30px; width: 25px;" name="dymList_{{ $index }}" class="input-group-addon" ng-model="list.groupSelected" ng-options="option as option.name for option in list.dymListDetGroup" ng-change="changeGroup(list)"></select>
											  		</div>
													<span class="input-group-addon" ng-show="list.dymListDetGroup.length == 0"><i class="fa fa-sticky-note"></i></span>
													<select name="dymList_{{ $index }}" class="form-control" ng-model="list.dymListVal" ng-options="option._id as (option.code ?  option.meaning + ' [' + option.code + ']' : option.meaning) for option in list.dymListDet" ng-change="askModalObj.selectedChange(list)">
														<option value="">--Select--</option>
											  		</select>
										  		</div>
											  </div>
										  </div>
									  </div>  
								  </div>
							  </div>
						  </div>
						</div>
		            </div>
		           	<div class="modal-footer">
		           		<button type="button" class="btn btn-warning pull-left" ng-click="keepData()">ปิด โดยไม่ล้างข้อมูล</button>
						<button type="button" class="btn btn-default" ng-click="dismissModalAsk()">ปิด</button>
						<button type="button" class="btn btn-success" ng-disabled="!askModalObj.trace.resultText || isOutOfWorkingTime" 
								ng-show="!askModalObj.trace['_id'] && askModalObj.trace.appointDate && askModalObj.trace.appointAmount" ng-click="askModalObj.askModalSave(true)">{{ askModalObj.isSaving ? 'กำลังบันทึก...' : 'บันทึก &amp; ประมาณการ' }}</button>
						<button type="submit" class="btn btn-primary" ng-disabled="!askModalObj.trace.resultText || isOutOfWorkingTime">{{ askModalObj.isSaving ? 'กำลังบันทึก...' : 'บันทึก' }}</button>
					</div>
		         </div>
		         </fieldset>
	         </form>
	     </div>
	 </div>
 </div>
 
 
 <div class="row" ng-show="isKYS">
	 <iframe id="kys"
					sandbox="allow-same-origin allow-scripts allow-popups allow-forms"
				    class="col-xs-12" style="border: 0; min-height: 1000px;"></iframe>
			    
 </div>
 <!-- <div ui-view></div> -->
<!-- / Modal -->
