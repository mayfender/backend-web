<style>
.editable-wrap {
    width: 100%;
}
.editable-controls {
	width: 100%;
}
</style>


<!-- <button type="button" class="btn btn-primary" title="{{ isOutOfWorkingTime ? 'นอกเวลาทำงาน' : 'บันทึกผลการติดตาม' }}" style="padding: 5px 15px 5px 15px; position: absolute; left: 598px; top: -36px;" ng-click="askModal()" ng-disabled="isOutOfWorkingTime || (taskDetails.length == 0)">
	<i class="fa fa fa-plus fa-1x"></i>
</button> -->

<div class="panel panel-info" style="margin: 0;" ng-style="askModalObj.isOldTrace ? {'border-color':'#EDBB99'} : {}">
	<div class="alert alert-info form-group input-group" style="position: relative; padding-top: 3px; padding-bottom: 3px; margin: 3px;" ng-style="askModalObj.isOldTrace ? {'background-color':'#F5CBA7'} : {}">
		<span class="input-group-addon" style="border: 0px; background: none; color: #337AB7;">
			{{'pagination.page' | translate}}: {{askModalObj.init.currentPage}} {{'pagination.of' | translate}} {{ numPages | number:0 }} ({{'pagination.total' | translate}} {{ askModalObj.init.traceData.totalItems | number:0 }} {{'pagination.items' | translate}})
		</span>
		
		<div class="checkbox_animate" style="position: absolute; bottom: 1px;">
			<label>
            	<input type="checkbox" value="" ng-model="askModalObj.isOldTrace" ng-change="askModalObj.trigerIsOldTrace()">
            	<span class="cr"><i class="cr-icon glyphicon glyphicon-ok"></i></span>
            	<i style="text-decoration: underline;  font-weight: bold;">ผลการติดตามเก่า</i>
          	</label>
        </div>
		
		<pagination ng-change="askModalObj.pageChanged()" total-items="askModalObj.init.traceData.totalItems"
					first-text="{{'pagination.first' | translate}}"
					previous-text="{{'pagination.previous' | translate}}"
					next-text="{{'pagination.next' | translate}}"
					last-text="{{'pagination.last' | translate}}"
					ng-model="askModalObj.init.currentPage" items-per-page="askModalObj.init.itemsPerPage"
					max-size="askModalObj.init.maxSize" class="pagination-sm pull-right" boundary-links="true"
					rotate="false" num-pages="numPages" style="margin: auto;" />
		<span class="input-group-addon" style="padding: 0px 5px 0px 3px; border: 0px; background: none; color: #337AB7;">
			<select style="height: 28px;" ng-options="option for option in [5,10,20,30,40,50,100] track by option" ng-model="askModalObj.init.itemsPerPage" 
					ng-change="askModalObj.changeItemPerPage()"></select>&nbsp;{{'pagination.per_page' | translate}}								
		</span>
	</div>
</div>

<div class="table-responsive" style="padding: 0; min-height: 223px;">
	<table class="table table-striped table-hover table-bordered" style="margin: 0;">
		<thead>
			<tr style="color: #337AB7; background-image: linear-gradient(#C7E2F0, #ebf5fa, #C7E2F0);">
				<th style="text-align: center; white-space: nowrap;">#</th>
				<th style="text-align: center; white-space: nowrap;" ng-show="onApi > 0"><i class="fa fa-cloud-upload fa-fw" title="ผลการส่งข้อมูล"></i></th>
				<th style="text-align: center; white-space: nowrap;">วันที่ติดตาม</th>
				<th style="text-align: center; white-space: nowrap;">ผลการติดตาม</th>
				<th style="text-align: center; white-space: nowrap;">เบอร์โทร</th>
				<th style="text-align: center; white-space: nowrap;">วันนัด Call</th>
				<th style="text-align: center; white-space: nowrap;">วันนัดชำระ</th>
				<th style="text-align: center; white-space: nowrap;">ยอดนัดชำระ</th>
				<th style="text-align: center; white-space: nowrap;" ng-repeat="list in dymList">{{ list.columnName }}</th>
				<th style="text-align: center; white-space: nowrap;" ng-hide="askModalObj.isOldTrace">ผู้บันทึก</th>
				<th style="text-align: center; white-space: nowrap;" ng-hide="askModalObj.isOldTrace"></th>
			</tr>
		<thead>
		<tbody>
			<tr ng-repeat="data in askModalObj.init.traceData.traceWorks track by $index" ng-style="data.isReadOnly ? (group1 ? {'cursor': 'pointer'} : {}) : (isEditable && !askModalObj.isOldTrace) ? {'cursor': 'pointer'} : {}" style="color: #337AB7;" ng-dblclick="data.isReadOnly ? (group1 ? askModal(data, $index) : '') : (isEditable && !askModalObj.isOldTrace) ? askModal(data, $index) : ''">
				<td style="text-align: center;  white-space: nowrap;">{{ $index + 1 + ((askModalObj.init.currentPage - 1) * askModalObj.init.itemsPerPage) }}</td>
				<td style="text-align: center; white-space: nowrap;" ng-show="onApi > 0">
					<span title="{{ data.uploadStatusDesc }}" ng-hide="data.uploadStatusCode == '0000I'">
					{{ data.uploadStatusCode == 'DMS_IGN' ? 'ไม่ส่ง' : data.uploadStatusCode }}
					</span>
					<i class="fa fa-check-circle fa-fw" ng-show="data.uploadStatusCode == '0000I'" style="color: #388c0d;" title="ส่งสำเร็จ"></i>					
				</td>
				<td style="text-align: center; white-space: nowrap;">{{ data.createdDateTime | date : gb_dateTimeFormat }}</td>
				<td style="white-space: nowrap;">{{ data.resultText }}</td>
				<td style="text-align: center; white-space: nowrap;">{{ data.tel }}</td>
				<td style="text-align: center; white-space: nowrap;">{{ data.nextTimeDate | date : gb_dateTimeFormat }}</td>
				<td style="text-align: center; white-space: nowrap;">{{ data.appointDate | date : gb_dateTimeFormat }}</td>
				<td style="text-align: right; white-space: nowrap;">{{ data.appointAmount | number:2 }}</td>
				
				<td style="text-align: center; white-space: nowrap;" ng-repeat="list in dymList">
					{{ 
					  list.type > 1 ? (list.type == 2 ? data[list.fieldName] : (list.type == 3 ? (data[list.fieldName] | number:2) : (data[list.fieldName] | date : gb_dateTimeFormat))) 
					  : (data['link_' + list.fieldName][0].code || data['link_' + list.fieldName][0].meaning) 
					}}
				</td>
				
				<td style="white-space: nowrap;" ng-hide="askModalObj.isOldTrace">{{ createdByLog == 1 ? data.taskDetail.sys_owner : data.createdByName }}</td>
				<td ng-click="askModalObj.deleteTraceDummy($event)" style="cursor: default; text-align: center;  white-space: nowrap;" ng-hide="askModalObj.isOldTrace">
					<i class="fa fa-times fa-lg user-action-icon-danger" title="ลบ" ng-click="askModalObj.deleteTrace($event, data._id)" ng-show="data.isReadOnly ? group1 : isEditable">&nbsp;</i>
					<!-- <i class="fa fa-home fa-lg user-action-icon-primary" title="เพิ่มที่อยู่" ng-click="askModalObj.addAddr($event, data._id)" ng-hide="data.isReadOnly"></i> -->
					<i class="fa fa-lock fa-lg" title="Read Only" ng-show="data.isReadOnly"></i>
				</td>
			</tr>
		</tbody>
	</table>
</div>

<div class="panel panel-info" style="margin-top: 3px; margin-bottom: 0;">
	<div class="panel-heading">
		<a ng-hide="isHideComment || askModalObj.isOldTrace" href="#" e-class="form-control" style="color: black;" e-style="width: 100%;" buttons="no" onaftersave="askModalObj.updateComment(askModalObj.comment)" editable-text="askModalObj.comment"> 
			{{ askModalObj.comment || 'บันทึกเพิ่มเติม'}} 
		</a>
		<span ng-show="isHideComment || askModalObj.isOldTrace">&nbsp;</span>
	</div>
</div>
